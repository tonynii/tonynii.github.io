(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{519:function(e,t,a){"use strict";a.r(t);var s=a(2),r=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[e._v("使用selenium进行网页自动化测试或者抓包时，大部分情况我们会使用firefox、chrome等主流浏览器，如果遇到非页面测试或对性能有要求的情况，我们可以使用无界面浏览器PhantomJS配合selenium使用，具体方法如下：")])]),t("h2",{attrs:{id:"下载phantomjs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载phantomjs"}},[e._v("#")]),e._v(" 下载PhantomJS")]),e._v(" "),t("p",[e._v("到这个网站下载"),t("a",{attrs:{href:"http://phantomjs.org/download.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("PhantomJS"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"selenium调用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#selenium调用"}},[e._v("#")]),e._v(" selenium调用")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("try:\n    pjs_bin = 'phantomjs.exe'\n    dr = webdriver.PhantomJS(executable_path=pjs_bin)\n    dr.get(url)\n    elem = dr.find_element_by_xpath(\"//*\")\n    i = elem.text\n    print('get {0} is {1}'.format(url,i))\nexcept Exception as err:\n    i = ''\n    print('get {0} error by {1}'.format(url,err))\nelse:\n    dr.quit()\n")])])]),t("blockquote",[t("p",[e._v("pjs_bin: 执行文件的路径，根据具体情况配置。如果不设置selenium会在PATH中寻找。")])]),e._v(" "),t("h2",{attrs:{id:"设置消息头"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置消息头"}},[e._v("#")]),e._v(" 设置消息头")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('from selenium.webdriver.common.desired_capabilities import DesiredCapabilities\ncapabilities = DesiredCapabilities.PHANTOMJS.copy()\ncapabilities["phantomjs.page.settings.userAgent"]="Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Mobile Safari/537.36" \ndr = webdriver.PhantomJS(executable_path=pjs_bin,desired_capabilities=capabilities)\ndr.set_window_size(1120, 550)\ndr.set_page_load_timeout(90)\ndr.set_script_timeout(90)\n')])])]),t("h2",{attrs:{id:"打开https页面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打开https页面"}},[e._v("#")]),e._v(" 打开https页面")]),e._v(" "),t("p",[e._v("PhantomJS默认使用SSLv3打开https网页，但通常一些网站不支持或不兼容SSLv3，造成页面显示空白，需要在启动driver时加上以下参数：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("dr = webdriver.PhantomJS(executable_path=pjs_bin,\ndesired_capabilities=capabilities,\nservice_args=['--ignore-ssl-errors=true', '--ssl-protocol=any'])\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);